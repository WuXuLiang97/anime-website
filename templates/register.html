<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>注册 - 动画视频网站</title>
  <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/static/css/style.css" />
  <style>
    /* 注册页面样式 */
    .auth-container {
      max-width: 400px;
      margin: 50px auto;
      padding: 30px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .auth-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .auth-header h1 {
      color: #2c3e50;
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    .auth-header p {
      color: #7f8c8d;
      font-size: 1rem;
    }

    .auth-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-group label {
      font-size: 0.9rem;
      color: #34495e;
      font-weight: 500;
    }

    .form-group input {
      padding: 12px 16px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.1);
    }

    .auth-btn {
      padding: 12px 20px;
      background: linear-gradient(135deg, #27ae60, #229954);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .auth-btn:hover {
      background: linear-gradient(135deg, #229954, #1e8449);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
    }

    .auth-link {
      text-align: center;
      margin-top: 20px;
    }

    .auth-link a {
      color: #3498db;
      text-decoration: none;
      font-size: 0.9rem;
      transition: color 0.3s ease;
    }

    .auth-link a:hover {
      color: #2980b9;
      text-decoration: underline;
    }

    .error-message {
      background: #fee;
      color: #e74c3c;
      padding: 10px 15px;
      border-radius: 6px;
      font-size: 0.9rem;
      margin-bottom: 20px;
      border-left: 4px solid #e74c3c;
    }

    .success-message {
      background: #efe;
      color: #27ae60;
      padding: 10px 15px;
      border-radius: 6px;
      font-size: 0.9rem;
      margin-bottom: 20px;
      border-left: 4px solid #27ae60;
    }
  </style>
</head>

<body>
  <div class="bili-header">
    <div class="bili-header__bar">
      <ul class="left-entry">
        <li>
          <a href="/" class="entry-title"> <svg width="32" height="32" viewBox="0 0 18 18" fill="none"
              xmlns="http://www.w3.org/2000/svg" class="zhuzhan-icon">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M3.73252 2.67094C3.33229 2.28484 3.33229 1.64373 3.73252 1.25764C4.11291 0.890684 4.71552 0.890684 5.09591 1.25764L7.21723 3.30403C7.27749 3.36218 7.32869 3.4261 7.37081 3.49407H10.5789C10.6211 3.4261 10.6723 3.36218 10.7325 3.30403L12.8538 1.25764C13.2342 0.890684 13.8368 0.890684 14.2172 1.25764C14.6175 1.64373 14.6175 2.28484 14.2172 2.67094L13.364 3.49407H14C16.2091 3.49407 18 5.28493 18 7.49407V12.9996C18 15.2087 16.2091 16.9996 14 16.9996H4C1.79086 16.9996 0 15.2087 0 12.9996V7.49406C0 5.28492 1.79086 3.49407 4 3.49407H4.58579L3.73252 2.67094ZM4 5.42343C2.89543 5.42343 2 6.31886 2 7.42343V13.0702C2 14.1748 2.89543 15.0702 4 15.0702H14C15.1046 15.0702 16 14.1748 16 13.0702V7.42343C16 6.31886 15.1046 5.42343 14 5.42343H4ZM5 9.31747C5 8.76519 5.44772 8.31747 6 8.31747C6.55228 8.31747 7 8.76519 7 9.31747V10.2115C7 10.7638 6.55228 11.2115 6 11.2115C5.44772 11.2115 5 10.7638 5 10.2115V9.31747ZM12 8.31747C11.4477 8.31747 11 8.76519 11 9.31747V10.2115C11 10.7638 11.4477 11.2115 12 11.2115C12.5523 11.2115 13 10.7638 13 10.2115V9.31747C13 8.76519 12.5523 8.31747 12 8.31747Z"
                fill="currentColor"></path>
            </svg>
            <span>首页</span>
          </a>
        </li>

      </ul>
      <form action="/search" method="get" class="search-form">
        <div class="search-box">
          <input type="text" name="keyword" id="search-input" placeholder="输入动画名称搜索（如：海贼王、火影忍者）..." required
            autocomplete="off" />
          <button type="submit" class="search-btn">
            <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
              stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            搜索
          </button>
        </div>
        <!-- 搜索建议区域 -->
        <div id="search-suggestions" class="search-suggestions"></div>
      </form>
      <ul class="right-entry">
        <li>
          <a href="/history" class="bili-header__nav-link">播放记录</a>
        </li>
        <li>
          <a href="/login" class="bili-header__nav-link">登录</a>
        </li>
      </ul>

    </div>
  </div>

  <div class="auth-container">
    <div class="auth-header">
      <h1>用户注册</h1>
      <p>创建一个新账号，开始您的动画之旅</p>
    </div>

    <div id="message-container"></div>

    <form id="register-form" class="auth-form">
      <div class="form-group">
        <label for="username">用户名</label>
        <input type="text" id="username" name="username" required placeholder="请输入用户名（至少3个字符）" />
      </div>

      <div class="form-group">
        <label for="email">邮箱</label>
        <input type="email" id="email" name="email" required placeholder="请输入邮箱地址" />
      </div>

      <div class="form-group">
        <label for="password">密码</label>
        <input type="password" id="password" name="password" required placeholder="请输入密码（至少6个字符）" />
      </div>

      <button type="submit" class="auth-btn">注册</button>
    </form>

    <div class="auth-link">
      <p>已有账号？ <a href="/login">立即登录</a></p>
    </div>
  </div>

  <script>
    // 处理注册表单提交
    document.getElementById('register-form').addEventListener('submit', async function (e) {
      e.preventDefault();

      const username = document.getElementById('username').value;
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const messageContainer = document.getElementById('message-container');

      // 显示加载状态
      messageContainer.innerHTML = '<div class="success-message">正在注册...</div>';

      try {
        const response = await fetch('/api/auth/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ username, email, password }),
        });

        const data = await response.json();

        if (data.status === 'success') {
          messageContainer.innerHTML = '<div class="success-message">注册成功，正在跳转到登录页面...</div>';
          // 跳转到登录页面
          setTimeout(() => {
            window.location.href = '/login';
          }, 1500);
        } else {
          messageContainer.innerHTML = `<div class="error-message">${data.error || '注册失败'}</div>`;
        }
      } catch (error) {
        messageContainer.innerHTML = '<div class="error-message">网络错误，请稍后重试</div>';
        console.error('注册失败:', error);
      }
    });
  </script>
</body>

</html>